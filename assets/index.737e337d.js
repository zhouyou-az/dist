import{_ as e,U as a}from"./DialogComponent.234733d9.js";import{S as l,D as t}from"./http.248f93ba.js";import{e as o,o as s,f as r,d as i,r as n,b as d,g as u,w as p,F as m,l as g,i as h}from"./index.20cbabfe.js";import{_ as c}from"./OrganizationTree.74edfe7f.js";import"./vendor.196df497.js";const f={props:{modelValue:{type:Object,default:{pageNo:1,pageSize:10,totalCount:0}},pageSizes:{type:Array,default:[10,20,30,40]}},methods:{handleSizeChange(e){this.modelValue.pageSize=e,this.$emit("change")},handleCurrentChange(e){this.modelValue.pageNo=e,this.$emit("change")}},data:()=>({})};f.render=function(e,a,l,t,i,n){const d=o("el-pagination");return s(),r(d,{onSizeChange:n.handleSizeChange,onCurrentChange:n.handleCurrentChange,"current-page":l.modelValue.pageNo,"page-sizes":l.pageSizes,"page-size":l.modelValue.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:l.modelValue.totalCount,class:"pagination"},null,8,["onSizeChange","onCurrentChange","current-page","page-sizes","page-size","total"])};var b=i({name:"OrganizationComponent",components:{DialogComponent:e,PaginationComponent:f,OrganizationTree:c},props:{},emits:[],setup(e){const a=n(),l=n(),t=n(),o=n();return{dialogRef:a,user:d({username:"",password:"",nickname:""}),userValidation:{name:[{required:!0,message:"请填写机构名称",trigger:"blur"}]},userDialogRef:l,parentNameInputRef:t,userRef:o}},data:()=>({tableHeader:[{label:"用户ID",prop:"id"},{label:"登录名称",prop:"username"},{label:"用户名称",prop:"nickname"}],dialogVisible:!1,userdialogVisible:!1,userList:[],userMap:new Map,searchFrom:{search:"",OrgId:"",status:null,orgId:null,pageSize:10,pageNo:1,totalCount:0}}),computed:{},watch:{},methods:{createUserDialog(e){this.userRef&&this.userRef.resetFields()},updateUserDialog(e){},loadUserPage(){a.queryPage(this.searchFrom).then((e=>{this.userList=e.data.result,this.searchFrom.totalCount=e.data.totalCount,this.userMap=this.userList.reduce(((e,a)=>(e.set(a.id,a),e)),new Map)}))},createUser(){a.create(this.user).then((e=>{e.success&&(l("新增机构成功"),this.loadUserPage(),this.dialogVisible=!1)}))},updateMneu(){a.update(this.user).then((e=>{e.success&&(l("编辑机构成功"),this.loadUserPage(),this.dialogVisible=!1)}))},removeUser(e){t().then((()=>{a.remove(e).then((e=>{e.success&&(l("删除机构成功"),this.loadUserPage(),this.dialogVisible=!1)}))}))}},created(){this.loadUserPage()}});const V={class:"flex",style:{height:"100%"}},C={class:"white-box light-shadow column-start",style:{width:"210px",overflow:"auto",padding:"0px"}},w={style:{height:"40px","border-bottom":"1px solid #ccc",padding:"0px 10px"},class:"row-between-center"},U=u("span",null,"组织机构",-1),x={style:{flex:"1","margin-left":"20px"},class:"column-start"},z={class:"white-box light-shadow search-bar row-start-center"},y=h("查询"),_={class:"white-box light-shadow column-start"},k={class:"opreate-row"},v=h("新增"),R=h("编辑"),D=h("新增"),S=h("删除"),F=h("选择");b.render=function(e,a,l,t,i,n){const d=o("el-button"),h=o("organization-tree"),c=o("el-input"),f=o("el-table-column"),b=o("el-switch"),N=o("el-table"),P=o("pagination-component"),I=o("el-form-item"),j=o("el-form"),M=o("dialog-component");return s(),r("div",V,[u("div",C,[u("div",w,[U,u(d,{class:"el-icon-edit-outline el-button-noneborder",round:"",style:{"font-size":"16px"}})]),u(h,{extendRoot:!1})]),u("div",x,[u("div",z,[u(c,{modelValue:e.searchFrom.search,"onUpdate:modelValue":a[1]||(a[1]=a=>e.searchFrom.search=a),style:{width:"200px","margin-right":"10px"},placeholder:"机构名称关键字"},null,8,["modelValue"]),u(d,{onClick:e.loadUserPage},{default:p((()=>[y])),_:1},8,["onClick"])]),u("div",_,[u("div",k,[u(d,{icon:"el-icon-plus",type:"primary",onClick:a[2]||(a[2]=a=>e.createUserDialog())},{default:p((()=>[v])),_:1})]),u(N,{data:e.userList,"row-key":"id","highlight-current-row":"","max-height":650},{default:p((()=>[(s(!0),r(m,null,g(e.tableHeader,(e=>(s(),r(f,{key:e.prop,label:e.label,prop:e.prop},null,8,["label","prop"])))),128)),u(f,{label:"部门"}),u(f,{label:"手机",prop:"mobile"}),u(f,{label:"电子邮箱",prop:"email"}),u(f,{label:"用户状态"},{default:p((e=>[u(b,{modelValue:e.row.status,"onUpdate:modelValue":a=>e.row.status=a},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),u(f,{label:"操作",width:300},{default:p((a=>[u(d,{onClick:l=>e.updateUserDialog(a.row)},{default:p((()=>[R])),_:2},1032,["onClick"]),u(d,{onClick:l=>e.createUserDialog(a.row)},{default:p((()=>[D])),_:2},1032,["onClick"]),u(d,{onClick:l=>e.removeUser(a.row.id)},{default:p((()=>[S])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),u(P,{modelValue:e.searchFrom,"onUpdate:modelValue":a[3]||(a[3]=a=>e.searchFrom=a),onChange:e.loadUserPage},null,8,["modelValue","onChange"]),u(M,{modelValue:e.dialogVisible,"onUpdate:modelValue":a[8]||(a[8]=a=>e.dialogVisible=a),ref:"dialogRef"},{default:p((()=>[u(j,{model:e.user,rules:e.userValidation,ref:"userRef","label-width":"100px"},{default:p((()=>[u(I,{label:"上级机构"},{default:p((()=>[u(c,{modelValue:e.user.parentName,"onUpdate:modelValue":a[5]||(a[5]=a=>e.user.parentName=a),readonly:"",onFocus:a[6]||(a[6]=a=>{e.userDialogRef.open({title:"机构选择"}),e.parentNameInputRef.blur()}),ref:"parentNameInputRef"},{append:p((()=>[u(d,{onClick:a[4]||(a[4]=a=>{e.userDialogRef.open({title:"机构选择"})})},{default:p((()=>[F])),_:1})])),_:1},8,["modelValue"]),u(c,{modelValue:e.user.parentId,"onUpdate:modelValue":a[7]||(a[7]=a=>e.user.parentId=a),style:{display:"none"}},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])])])};export default b;
